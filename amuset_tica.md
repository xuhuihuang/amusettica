# AMUSET-TICA

AMUSET-TICA is a collective variable identification method based on tICA and AMUSEt.

Input data: a list of trajectories, each trajectory is an (n_frames, n_features) list containing the input features of each frame. For example, the tICs of tICA generated by msmbuilder.decomposition.tICA.transform().

Input parameters: (1) A list of numbers of Gaussian basis. e.g.: [4,3,2] will use 3 input features, generating 4, 3 and 2 Gaussian basis from input feature 1, 2 and 3, respectively. (2) the covariance of Gaussian basis, sigma. (3) the lag time

## Installation:

Copy amuset_tica.py to your current folder.

Or copy amuset_tica.py to any folder, and use ``conda develop`` to add this path to environment if you are using Anaconda.

## A brief tutorial:

```
import amuse_tica

# perform tICA at lag time 5, and generate 10 tICs
import msmbuilder.decomposition.tICA
tica = msmbuilder.decomposition.tICA(n_components=10, lag_time=5)
tica_trajectories = tica.fit_transform(feature_trajectories, 10)

# perform AMUSET-TICA with:
#    top 3 of the input tICs;
#    (2+2+2)=6 Gaussian basis (leading to (1+7)^3=343 basis in tensor train structure)
#    sigma=1, and lag time 10
basis_list = amuse_tica.Basis.find(tica_trajectories, [2,2,2], sigma=1)
atica = amuse_tica.AmusetTICA()
fit = atica.fit(basis_list, tica_trajectories, lag_time=10)
print("implied timescales:", ttica.timescales_[:20])

# generate collective variable trajectories with top 5 CVs
cv_trajectories = atica.transform(tica_trajectories, 5)
cv_trajectories = atica.transform(tica_trajectories, [1,2,3,4,5])
```
